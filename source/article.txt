MERGE (paper:Paper {ID: ToInteger(line.article), title: coalesce(line.title,''), keywords:coalesce(split(line.keywords,'|'), ''), abstract:coalesce(line.abstract,''), pages:coalesce(line.pages,''),last_modification:coalesce(date(line.mdate),''), DOI: coalesce(line.ee, '') })
MERGE (journal:Journal {name: line.journal, volume: coalesce(ToInteger(line.volume), ''), year: ToInteger(line.year)})
MERGE  ((journal)-[r:Publishes]->(paper))
MERGE (corr_author: Author {name:line.corresponding, ID: line.correspondingID})
FOREACH (auth in split(line.co_authors,'|')| MERGE (author:Author {name: auth}) MERGE ((author)-[r:Writes {corresponding:False}]->(paper)))
MERGE (corr_author)-[:Writes {corresponding:True}]->(paper)
FOREACH (cit in SPLIT(line.citations, '|') | MERGE (paper2: Paper{ID: ToInteger(cit)}) MERGE
(paper)-[:Cites]->(paper2))
FOREACH (rev in SPLIT(line.reviewed_by, '|') | MERGE (author2:Author {name: rev}) MERGE
((author2)-[:Reviews]->(paper)));