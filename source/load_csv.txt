CREATE CONSTRAINT ON (c:Journal) ASSERT (c.name, c.year) IS NODE KEY;
CREATE CONSTRAINT ON (c:Article) ASSERT c.ID IS UNIQUE;
CREATE CONSTRAINT ON (c:Author) ASSERT c.name is UNIQUE;
LOAD CSV WITH HEADERS FROM
'file:///proceeding_papers.csv' AS line FIELDTERMINATOR ';'
WITH line LIMIT 500
MERGE (corr_author: Author {name:line.corresponding})
MERGE (paper:Paper {ID: ToInteger(line.inproceedings), title: coalesce(line.title,""), keywords:coalesce(split(line.keywords,'|'), ""), abstract:coalesce(line.abstract,""), pages:coalesce(line.pages,""),last_modification:coalesce(date(line.mdate),""), DOI: coalesce(line.ee, "")})
MERGE (corr_author)-[:Writes {corresponding:True}]->(paper)
FOREACH (auth in split(line.co_authors,'|')| MERGE (author:Author {name: auth}) MERGE ((author)-[r:Writes {corresponding:False}]->(paper)))
FOREACH (cit in SPLIT(line.citations, '|') | MERGE (paper2: Paper{ID: ToInteger(cit)}) MERGE
(paper)-[:Cites]->(paper2))
FOREACH (rev in SPLIT(line.reviewed_by, '|') | MERGE (author2:Author {name: rev}) MERGE
((author2)-[:Reviews]->(paper)))
MERGE (proceeding: Proceeding {ID: ToInteger(line.proceedings), title: coalesce(line.booktitle, "")})
MERGE (proceeding)-[:Contains]->(paper);
LOAD CSV WITH HEADERS FROM
'file:///article.csv' AS line FIELDTERMINATOR ';'
WITH line LIMIT 1500
MERGE (paper:Paper {ID: ToInteger(line.article), title: coalesce(line.title,""), keywords:coalesce(split(line.keywords,'|'), ""), abstract:coalesce(line.abstract,""), pages:coalesce(line.pages,""),last_modification:coalesce(date(line.mdate),""), DOI: coalesce(line.ee, "") })
MERGE (journal:Journal {name: line.journal, volume: coalesce(ToInteger(line.volume), ""), year: ToInteger(line.year)})
MERGE  ((journal)-[r:Publishes]->(paper))
MERGE (corr_author: Author {name:line.corresponding, ID: line.correspondingID})
FOREACH (auth in split(line.co_authors,'|')| MERGE (author:Author {name: auth}) MERGE ((author)-[r:Writes {corresponding:False}]->(paper)))
MERGE (corr_author)-[:Writes {corresponding:True}]->(paper)
FOREACH (cit in SPLIT(line.citations, '|') | MERGE (paper2: Paper{ID: ToInteger(cit)}) MERGE
(paper)-[:Cites]->(paper2))
FOREACH (rev in SPLIT(line.reviewed_by, '|') | MERGE (author2:Author {name: rev}) MERGE
((author2)-[:Reviews]->(paper)));




